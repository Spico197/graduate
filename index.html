<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://unpkg.com/boltcss/bolt.min.css">
	<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
	<title>ä»€ä¹ˆæ—¶å€™èƒ½æ¯•ä¸š</title>
</head>

<body>
	<header>
		<h1 class="main-title">ğŸ˜¿ ä»€ä¹ˆæ—¶å€™èƒ½æ¯•ä¸šå“‡</h1>
		<p>ğŸ¥¤ ä½¿ç”¨å…ˆè¿›çš„AIæ¨ç†ç®—æ³•ï¼Œç»“åˆä½ çš„å®é™…æƒ…å†µï¼Œè®¡ç®—æ¯•ä¸šç»“æœã€‚</p>
		<p>ğŸ“š è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œå°†ä¸ºæ‚¨æä¾›æœ€ä¸“ä¸šçš„å½•ç”¨ç»“æœé¢„æµ‹ã€‚</p>
		ğŸ”— <a href="https://github.com/Spico197/graduate" target="_blank">github.com/Spico197/graduate</a>
		<hr>
	</header>

	<main id="app">
		<label for="univ">å­¦æ ¡</label>
		<p class="note">è¯·å°½å¯èƒ½å†™å…¨ç§°ï¼Œå¦‚ï¼šâ€œSoochow Universityâ€</p>
		<input v-model="univ" class="full-width" id="univ" type="text">
		<label for="year">å…¥å­¦å¹´ä»½</label>
		<p class="note">è¯·å¡«å†™æœ€è¿‘ä¸€æ®µå­¦ä¹ ç»å†çš„å…¥å­¦æ—¶é—´ï¼Œå¦‚ï¼šâ€œ2021â€</p>
		<input v-model="year" class="full-width" id="year" type="number">
		<label for="expected-year">é¢„æœŸæ¯•ä¸šå¹´ä»½</label>
		<p class="note">è¯·å¡«å†™è®¡åˆ’çš„æ¯•ä¸šæ—¶é—´ï¼Œå¦‚ï¼šâ€œ2024â€</p>
		<input v-model="expectedYear" class="full-width" id="expected-year" type="number">
		<label for="keywords">ç ”ç©¶æ–¹å‘</label>
		<p class="note">ä½¿ç”¨é€—å·éš”å¼€å¤šä¸ªï¼Œå¦‚ï¼šâ€œä¿¡æ¯æŠ½å–ï¼Œäº‹ä»¶æŠ½å–â€</p>
		<input v-model="keywords" class="full-width" id="keywords" type="text">
		<div>
			<label for="lucky-num">å¿ƒé‡Œçš„æ•°å­—</label>
			<p class="note">è¯·é—­ä¸Šçœ¼ç›ï¼Œåœ¨å¿ƒé‡Œæƒ³ä¸‰ä¸ªæ­£æ•´æ•°ï¼Œç„¶ååˆ†åˆ«å¡«å…¥ä¸‹åˆ—çš„æ¡†ä¸­ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ä¸‰ä¸ªæ•°å­—<strong>åŒºåˆ†é¡ºåº</strong></p>
			<div>
				<input v-model="luckyNum1" class="lucky-num" type="number" placeholder="æ•°å­—1">
				<input v-model="luckyNum2" class="lucky-num" type="number" placeholder="æ•°å­—2">
				<input v-model="luckyNum3" class="lucky-num" type="number" placeholder="æ•°å­—3">
			</div>
		</div>
		<div class="center">
			<div v-if="acceptMsgFlag">
				<div class="confetti-container" ref="confettiContainer"></div>
				<p class="accept-msg">ä½  <strong class="green">å¯ä»¥</strong> å¦‚æœŸæ¯•ä¸šï¼</p>
			</div>
			<button class="compute-btn" @click="startComputation">å¼€å§‹è®¡ç®—</button>
			<div v-if="timerHandler">
				<p>â±ï¸ {{ searchSecondsTwoDecimal }}</p>
			</div>
		</div>
	</main>

	<footer>
		<hr>
		<p>æ°¸è¿œç›¸ä¿¡ç¾å¥½çš„äº‹æƒ…å³å°†å‘ç”Ÿ</p>
		<p>â¤ï¸ ç¥ä½ é¡ºåˆ©æ¯•ä¸šï¼Œæ‹¥æŠ±ç¾å¥½æ–°ç”Ÿæ´»</p>
	</footer>

	<style>
		body {
			max-width: 800px;
			width: 100%;
			margin: 20px auto;
			padding: 0 20px;
		}

		label {
			margin-top: 0.5rem;
			font-weight: bold;
		}

		footer {
			text-align: center;
		}

		hr {
			margin-top: 2rem;
			margin-bottom: 2rem;
		}

		.main-title {
			margin-top: 3rem;
		}

		.full-width {
			max-width: 100%;
			width: 100%;
			margin-top: 10px;
			margin-bottom: 20px;
			padding: 10px;
			font-size: 1rem;
		}

		.note {
			font-size: 0.9rem;
			color: #666;
			margin-top: auto;
			margin-bottom: auto;
		}

		.lucky-num {
			margin-right: 1rem;
		}

		.center {
			text-align: center;
		}

		.compute-btn {
			margin-top: 2rem;
			background-color: #ffc83d;
			color: #d67d00;
			font-weight: bold;
		}

		.compute-btn:hover {
			background-color: #ffc83dc0;
		}

		.accept-msg {
			margin-top: 2rem;
			font-size: 1.5rem;
		}

		.green {
			color: #4caf50;
		}
	</style>
</body>

<script>
	const { createApp, ref, computed, onMounted, onUnmounted } = Vue
	createApp({
		setup() {
			const univ = ref('')
			const year = ref()
			const expectedYear = ref()
			const keywords = ref('')
			const luckyNum1 = ref()
			const luckyNum2 = ref()
			const luckyNum3 = ref()

			const acceptMsgFlag = ref(false)
			const timerHandler = ref(0)
			const searchSeconds = ref(0.0)
			const searchSecondsTwoDecimal = computed(() => {
				return `${searchSeconds.value.toFixed(1)}s`
			})
			function startTimer() {
				timerHandler.value = setInterval(() => {
					searchSeconds.value += 0.1
				}, 100)
			}

			function endTimer() {
				if (timerHandler.value > 0) {
					clearInterval(timerHandler.value)
				}
				timerHandler.value = 0
			}

			function getRandomSecondsFromRange(min, max) {
				return 1000 * Math.random() * (max - min) + min;
			}

			const numParticles = 200;
			const particleDefaults = {
				origin: { y: 0.7 }
			};

			function fire(particleRatio, opts) {
				confetti({
					...particleDefaults,
					...opts,
					particleCount: Math.floor(numParticles * particleRatio)
				});
			}

			function celebrate() {
				fire(0.25, {
					spread: 26,
					startVelocity: 55,
				});
				fire(0.2, {
					spread: 60,
				});
				fire(0.35, {
					spread: 100,
					decay: 0.91,
					scalar: 0.8
				});
				fire(0.1, {
					spread: 120,
					startVelocity: 25,
					decay: 0.92,
					scalar: 1.2
				});
				fire(0.1, {
					spread: 120,
					startVelocity: 45,
				});
			}

			function isNumber(inputVal) {
				return !isNaN(parseFloat(inputVal)) && isFinite(inputVal);
			}

			function validForm() {
				if (year.value < 0 || expectedYear.value < 0 || univ.value === '' || keywords.value === '' || luckyNum1.value < 0 || luckyNum2.value < 0 || luckyNum3.value < 0) {
					alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯ï¼')
					return false
				}
				const thisYear = new Date().getFullYear()
				if (!isNumber(expectedYear.value) || expectedYear.value < thisYear) {
					alert('é¢„è®¡æ¯•ä¸šå¹´ä»½å¿…é¡»æ˜¯æ•°å­—ï¼Œä¸”å¿…é¡»æ˜¯ä»Šå¹´æˆ–å°†æ¥çš„å¹´ä»½ï¼')
					return false
				}
				if (!isNumber(year.value) || year.value > thisYear) {
					alert('å…¥å­¦å¹´ä»½å¿…é¡»æ˜¯æ•°å­—ï¼Œä¸”å¿…é¡»æ˜¯ä»Šå¹´æˆ–è¿‡å»çš„å¹´ä»½ï¼')
					return false
				}
				if (expectedYear.value - year.value < 2) {
					alert('å…¥å­¦å¹´ä»½å’Œé¢„æœŸæ¯•ä¸šå¹´ä»½é—´å¿…é¡»>=2å¹´ï¼')
					return false
				}
				if (!isNumber(luckyNum1.value) || !isNumber(luckyNum2.value) || !isNumber(luckyNum3.value)) {
					alert('è¯·æ­£ç¡®å¡«å†™å¿ƒé‡Œçš„æ•°å­—ï¼')
					return false
				}
				if (luckyNum1.value === luckyNum2.value || luckyNum1.value === luckyNum3.value || luckyNum2.value === luckyNum3.value) {
					alert('è¯·ç¡®ä¿ä¸‰ä¸ªæ•°å­—ä¸ç›¸åŒï¼')
					return false
				}
				if (luckyNum1.value < 0 || luckyNum2.value < 0 || luckyNum3.value < 0) {
					alert('è¯·å¡«å†™æ­£æ•´æ•°ï¼')
					return false
				}
				return true
			}

			function startComputation() {
				/*
					â­ æ­å–œä½ å‘ç°äº†è¿™ä¸ªå½©è›‹ï¼
					ğŸ’– ç›¸ä¿¡ä½ é€šè¿‡è‡ªå·±çš„åŠªåŠ›ï¼Œç»ˆæœ‰ä¸€å¤©ä¼šåˆ›é€ å½©è™¹ğŸŒˆ
				*/
				if (!validForm()) {
					return
				}

				acceptMsgFlag.value = false
				startTimer()
				let randomNum = getRandomSecondsFromRange(1.0, 3.0)
				console.log('randomNum:', randomNum)
				setTimeout(() => {
					endTimer()
					celebrate()
					acceptMsgFlag.value = true
				}, randomNum)
			}

			return {
				year,
				expectedYear,
				univ,
				keywords,
				luckyNum1,
				luckyNum2,
				luckyNum3,
				timerHandler,
				searchSecondsTwoDecimal,
				startComputation,
				acceptMsgFlag,
			}
		}
	}).mount('#app')
</script>

</html>